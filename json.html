<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <p id="showResult"></p>
    <button onclick="showRowCnt()">보여줘</button><br>
    <button onclick="updateResult()" id="update">변경</button> 
    <script>
        let data =[{
                "id": 1,
                "first_name": "Jessie",
                "last_name": "Van Der Weedenburg",
                "email": "jvanderweedenburg0@163.com",
                "gender": "Male",
                "ip_address": "128.126.249.189"
            },
            {
                "id": 2,
                "first_name": "Brandice",
                "last_name": "Hallsworth",
                "email": "bhallsworth1@arstechnica.com",
                "gender": "Female",
                "ip_address": "240.188.48.222"
            },
            {
                "id": 3,
                "first_name": "Gabrielle",
                "last_name": "Capewell",
                "email": "gcapewell2@webmd.com",
                "gender": "Female",
                "ip_address": "145.22.123.75"
            },
            {
                "id": 4,
                "first_name": "Brooke",
                "last_name": "Oldam",
                "email": "boldam3@census.gov",
                "gender": "Male",
                "ip_address": "150.246.115.179"
            },
            {
                "id": 5,
                "first_name": "Shawnee",
                "last_name": "Goodenough",
                "email": "sgoodenough4@abc.net.au",
                "gender": "Female",
                "ip_address": "210.249.244.153"
            },
            {
                "id": 6,
                "first_name": "Joela",
                "last_name": "Dahl",
                "email": "jdahl5@google.com.br",
                "gender": "Female",
                "ip_address": "44.1.150.175"
            },
            {
                "id": 7,
                "first_name": "Julina",
                "last_name": "Hotton",
                "email": "jhotton6@seattletimes.com",
                "gender": "Female",
                "ip_address": "223.33.72.133"
            },
            {
                "id": 8,
                "first_name": "Marsh",
                "last_name": "Silvers",
                "email": "msilvers7@vinaora.com",
                "gender": "Male",
                "ip_address": "142.66.216.253"
            },
            {
                "id": 9,
                "first_name": "Perren",
                "last_name": "Jennings",
                "email": "pjennings8@reverbnation.com",
                "gender": "Male",
                "ip_address": "225.157.186.60"
            },
            {
                "id": 10,
                "first_name": "Coleman",
                "last_name": "Peachment",
                "email": "cpeachment9@sphinn.com",
                "gender": "Male",
                "ip_address": "119.115.84.228"
            },
            {
                "id": 11,
                "first_name": "Florry",
                "last_name": "Rahlof",
                "email": "frahlofa@opensource.org",
                "gender": "Female",
                "ip_address": "173.196.8.193"
            },
            {
                "id": 12,
                "first_name": "Claire",
                "last_name": "Angelo",
                "email": "cangelob@weibo.com",
                "gender": "Male",
                "ip_address": "53.131.171.137"
            },
            {
                "id": 13,
                "first_name": "Craig",
                "last_name": "Deddum",
                "email": "cdeddumc@nationalgeographic.com",
                "gender": "Male",
                "ip_address": "93.58.75.221"
            },
            {
                "id": 14,
                "first_name": "Ashlee",
                "last_name": "Lawes",
                "email": "alawesd@diigo.com",
                "gender": "Female",
                "ip_address": "202.196.199.245"
            },
            {
                "id": 15,
                "first_name": "Pippo",
                "last_name": "Blaiklock",
                "email": "pblaiklocke@mayoclinic.com",
                "gender": "Male",
                "ip_address": "76.20.226.29"
            },
            {
                "id": 16,
                "first_name": "Valentia",
                "last_name": "Rehm",
                "email": "vrehmf@squidoo.com",
                "gender": "Female",
                "ip_address": "215.136.69.106"
            },
            {
                "id": 17,
                "first_name": "Davin",
                "last_name": "Budnik",
                "email": "dbudnikg@salon.com",
                "gender": "Male",
                "ip_address": "157.90.211.59"
            },
            {
                "id": 18,
                "first_name": "Eva",
                "last_name": "Leggs",
                "email": "eleggsh@clickbank.net",
                "gender": "Female",
                "ip_address": "249.238.176.254"
            },
            {
                "id": 19,
                "first_name": "Son",
                "last_name": "Thews",
                "email": "sthewsi@chronoengine.com",
                "gender": "Male",
                "ip_address": "215.41.217.253"
            },
            {
                "id": 20,
                "first_name": "Georgeta",
                "last_name": "Stirrip",
                "email": "gstirripj@apple.com",
                "gender": "Female",
                "ip_address": "111.122.240.91"
            }
        ]

        // for(let field in data[19]){
        //         console.log(field, data[19][field]);
        //     }
        //     for (let datum of data){
        //         console.log(datum);
        //     }

        for(let i =0; i<10; i++)
            data.pop();

        let fields = ["first_name", "id", "last_name","button"];
        let table, tr, td, text;
        table = document.createElement("table");
        table.setAttribute('border', '1');
        
        tr = document.createElement("tr");
        
        for(let title of fields){
            th = document.createElement("th");
            text = document.createTextNode(title.replace("_","").toUpperCase());
            th.appendChild(text);
            tr.appendChild(th);
        }
        table.appendChild(tr);

        for(let i = 0; i<fields.length; i++){
                let label = document.createElement("label")
                label = document.createTextNode(fields[i]);

                let input = document.createElement("input")

                input.setAttribute("type","text")
                input.setAttribute("id",fields[i])

                document.body.appendChild(label)
                document.body.appendChild(input)
                
            }

        data.forEach(function (obj, idx, ary) {
            //한건 => tr에 담기
            tr = document.createElement("tr");
            tr.addEventListener("mouseover",function(){
                this.style.background = "yellow";
            })
            tr.addEventListener("mouseout",function(){
                this.style.background = "";
            })
            tr.addEventListener("click",function(){
                localStorage.setItem("rowNum", idx);
                localStorage.setItem("first_name", this.childNodes[0].firstChild.nodeValue);
                localStorage.setItem("id", this.childNodes[1].firstChild.nodeValue);
                localStorage.setItem("last_name", this.childNodes[2].firstChild.nodeValue);
                document.getElementById("first_name").value = this.childNodes[0].childNodes[0].nodeValue;
                document.getElementById("id").value = this.childNodes[1].childNodes[0].nodeValue;
                document.getElementById("last_name").value = this.childNodes[2].childNodes[0].nodeValue;
                
            })
            

            

            for (let field of fields) {
                if(field === 'button'){
                //<td><button>수정</button></td>
                    td = document.createElement("td");
                    let btn = document.createElement("button");
                    btn.innerHTML = "수정";
                    td.appendChild(btn);
                    tr.appendChild(td);
                    btn.onclick = function(){
                        //console.log(this.parentNode.parentNode.childNodes[1].firstChild.nodeValue);
                        let fName = this.parentNode.parentNode.childNodes[0].firstChild.nodeValue;
                        let id = this.parentNode.parentNode.childNodes[1].firstChild.nodeValue;
                        let lName = this.parentNode.parentNode.childNodes[2].firstChild.nodeValue;
                        

                        window.location.href = "jsonDetail.jsp?id="+ id +"&first_name="+fName+"&last_name="+lName;
                        
                    }
                }else{
               // console.log(obj[field]);
                td = document.createElement("td");
                text = document.createTextNode(obj[field]);
                td.appendChild(text);
                tr.appendChild(td);
                }
            }
            table.appendChild(tr);
        });


        document.getElementById("showResult").appendChild(table);

        function showRowCnt(){
            console.log(localStorage.getItem("last_name"));
        }

        
        



        
            
        


        // function updatefield(){
        //     let id = localStorage.getItem("id");
        //     let trs = document.querySelectorAll("tr");
        //     for(let i=0; i<trs.length; i++){
        //         if(trs[i]===id){
        //             trs[i].childNodes[1].firstChild.nodeValue 
        //         }
        //     }
        // }
        
        

       
        
    </script>

</body>

</html>